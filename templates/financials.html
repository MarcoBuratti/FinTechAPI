{% extends 'index.html' %}

{% block body %}
  <div class="container py-3">
  <form method="POST">
      <br>
      <h2>Set your parameters</h2>
      <div class="row">
          <div class="form-group col">
              <label for="inputState">Exchange</label>
              <select id="inputState" name="exchange" class="form-control">
                {% for le in listaExchange %}
                <option value="{{ le }}">{{ le }}</option>
            {% endfor %}
              </select>
          </div>
          <div class="form-group col">
              <label for="inputState">Sector</label>
              <select id="inputState" name="sector" class="form-control">
                {% for li in listaSector %}
                    <option value="{{ li }}">{{ li }}</option>
                {% endfor %}
              </select>
          </div>
          <div class="form-group col">
              <label for="inputState">Market Cap</label>
              <select id="inputState" name="price" class="form-control">
                {% for sp in stockPrice %}
                    <option value="{{ sp }}">{{ sp }}</option>
                {% endfor %}
              </select>
          </div>
      </div>
      <h3>Select a company and get financial analysis</h3>
      <div class="row">
        <div class="col">
          <br>
          <button type="submit" class="btn btn-primary">Submit</button>
        </div>
      </div>
      <br>
      <div class="table-wrapper-scroll-y my-custom-scrollbar">
        <table class="table table-bordered table-striped mb-0">
          <thead>
            <tr>
              <th scope="col">Name</th>
              <th scope="col">Ticker</th>
              <th scope="col">Price</th>
              <th scope="col">Market Cap</th>
              <th scope="col">select Item</th>
            </tr>
          </thead>
          <tbody>
            {% for elem in bigList %}
              <tr>
                <td>{{ elem['name'] }}</td>              
                <td> {{ elem['ticker'] }}</td>
                <td>{{ elem['price'] }}</td>
                <td>{{ elem['marketCap'] }}</td>
                <td><button type="submit" name="ticker" value="{{ elem['ticker'] }}" class="btn btn-primary btn-sm">Select</button></td>
              </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
  </form>
  </div>
  <div class="container py-3">
      <div class="row">
        <div class="col">
          <script src="http://d3js.org/d3.v3.min.js"></script>
            <script type="module">
              import define from "../static/js/index.js";
              import {Runtime, Library, Inspector} from "../static/js/runtime.js";

              const runtime = new Runtime();
              const main = runtime.module(define, Inspector.into(document.body));
          </script>
        </div>
      </div>
  </div>

  <div class="container py-3">

      <div class="row">
        <div class="col">
          <h3>{{ result }}</h3>
          <p style="text-align: justify;">
            {{ description }}
          </p>
          <br>
        </div> 
      </div>

  </div>

  <div class="container py-3">
    <div class="container">
      <div class="row">
        {% for elem in figDCF %}
        <div class="col"> 
            <div class="chart" id="{{ elem.ds }}">
                <script>
                    var graphs = {{ elem.fig|safe }};
                    Plotly.plot('{{ elem.ds }}',graphs,{});
                </script>
            </div>
        </div>
        <div class="col">
          <br>
          <br>
          <br>
          <br>
          {{ elem.comment }}
        </div>
        {% endfor %}
      </div>
  </div>
    <!-- TradingView Widget BEGIN -->
  <div class="tradingview-widget-container">
      <div id="tradingview_21b36">
      {% for elem in link %}
      <div class="tradingview-widget-copyright"><a href= "https://www.tradingview.com/symbols/" rel="noopener" target="_blank"><span class="blue-text"></span></a></div>
      <script type="text/javascript" src= "https://s3.tradingview.com/tv.js"></script> 
      
      <script type="text/javascript">
      new TradingView.widget(
      {
      "width": 980,
      "height": 610,
      "symbol": "{{ link.ticker }}",
      "interval": "D",
      "timezone": "Etc/UTC",
      "theme": "light",
      "style": "1",
      "locale": "en",
      "toolbar_bg": "#f1f3f6",
      "enable_publishing": false,
      "allow_symbol_change": true,
      "container_id": "tradingview_21b36"
    }
      );
      </script>
      {% endfor %}
    </div>
  </div>
  <!-- TradingView Widget END -->
  <br>
  <div class="container py-3">
      <div class="row">
        {% for elem in revenues %}
        <div class="col">
              <div class="container">
                  <div class="articles-container">   
                      <div class="chart" id="{{ elem.ds }}" width="100%" height="100%">
                          <script>
                              var graphs = {{ elem.fig|safe }};
                              Plotly.plot('{{ elem.ds }}',graphs,{});
                          </script>
                      </div>
                  </div>
              </div>
              <p>
              {{ elem.comment }}
              </p>
        </div> 
        {% endfor %}
      </div>
  </div>

  <!-- Card Display -->
  <div class="container py-3">
      <div class="row">
      {% for elem in finHealth %}
        <div class="col">
          <div class="container">
              <div class="articles-container">   
                  <div class="chart" id="{{ elem.ds }}">
                      <script>
                          var graphs = {{ elem.fig|safe }};
                          Plotly.plot('{{ elem.ds }}',graphs,{});
                      </script>
                  </div>
              </div>
          </div>
        </div>
      {% endfor %}
      <br>
      <br>
      <p>{{ descriptionFinancialHealth }}</p>
      </div>
  </div>

  <div class="container py-3">
      <div class="row">
        {% for elem in indicator %}
        <div class="col">
          <div class="container">
              <div class="articles-container">   
                  <div class="chart" id="{{ elem.ds }}">
                      <script>
                          var graphs = {{ elem.fig|safe }};
                          Plotly.plot('{{ elem.ds }}',graphs,{});
                      </script>
                  </div>
              </div>
          </div>
          <p>
            {{ elem.comment }}
          </p>
        </div>
        {% endfor %}
      </div>
  </div>
    
  <br>
  <br>
{% endblock %}